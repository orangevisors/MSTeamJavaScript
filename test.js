"use strict";var e=require("ava");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("@k2oss/k2-broker-core/test-framework"),require("./index");var s=a(e);function t(e,a){global[e]=a}function l(e){t("XMLHttpRequest",class{constructor(){this.recorder={},this.recorder.headers={}}open(e,a){this.recorder.opened={method:e,url:a}}setRequestHeader(e,a){this.recorder.headers[e]=a}send(){queueMicrotask(()=>{this.readyState=4,this.status=200,this.responseText=JSON.stringify(e),this.onreadystatechange(),delete this.responseText})}})}s.default("onexecute fails for invalid object",e=>{e.throws((function(){onexecute("invalidObject","",{},{})}))}),s.default.serial("onexecuteTeamArchive succeeds",async e=>{let a=Team,s=TeamArchive,n={[TeamId]:1234};l(n);let u=null;t("postResult",(function(e){u=e})),await onexecute(a,s,{},n),e.deepEqual(u,{[TeamId]:1234,[TeamRequestStatusUrl]:void 0,[TeamIsSuccessful]:!0}),e.pass()}),s.default.serial("onexecuteTeamUnarchive succeeds",async e=>{let a=Team,s=TeamUnarchive,n={[TeamId]:4321};l(n);let u=null;t("postResult",(function(e){u=e})),await onexecute(a,s,{},n),e.deepEqual(u,{[TeamId]:4321,[TeamRequestStatusUrl]:void 0,[TeamIsSuccessful]:!0}),e.pass()}),s.default.serial("onexecuteTeamClone succeeds",async e=>{let a=Team,s=TeamClone,n={[TeamId]:999,[TeamDisplayName]:"SomeName",[TeamDescription]:"SomeDescription",[TeamMailNickname]:"SomeMailNickname"};l(n);let u=null;t("postResult",(function(e){u=e})),await onexecute(a,s,{},n),e.deepEqual(u,{[TeamId]:999,[TeamRequestStatusUrl]:void 0,[TeamIsSuccessful]:!0}),e.pass()}),s.default.serial("onexecuteTeamUpdate succeeds",async e=>{let a=Team,s=TeamUpdate,n={[TeamId]:555,[TeamMsAllowCreateUpdateChannels]:!0,[TeamMsAllowDeleteChannels]:!0,[TeamMsAllowAddRemoveApps]:!0,[TeamMsAllowCreateUpdateRemoveTabs]:!0,[TeamMsAllowCreateUpdateRemoveConnectors]:!0,[TeamGsAllowCreateUpdateChannels]:!0,[TeamGsAllowDeleteChannels]:!0,[TeamMsgAllowUserEditMessages]:!0,[TeamMsgAllowUserDeleteMessages]:!0,[TeamMsgAllowTeamMentions]:!0,[TeamMsgAllowChannelMentions]:!0,[TeamFsAllowGiphy]:!0,[TeamFsAllowStickersAndMemes]:!0,[TeamFsAllowCustomMemes]:!0};l(n);let u=null;t("postResult",(function(e){u=e})),await onexecute(a,s,{},n),e.deepEqual(u,{[TeamIsSuccessful]:!0}),e.pass()}),s.default.serial("onexecuteChannelUpdate succeeds",async e=>{let a=Channel,s=ChannelUpdate,n={[ChannelId]:777,[ChannelTeamId]:888,[ChannelDisplayName]:"SomeName",[ChannelDescription]:"SomeDescription"};l(n);let u=null;t("postResult",(function(e){u=e})),await onexecute(a,s,{},n),e.deepEqual(u,{[ChannelIsSuccessful]:!0}),e.pass()}),s.default.serial("onexecuteChannelDelete succeeds",async e=>{let a=Channel,s=ChannelDelete,n={[ChannelId]:345,[ChannelTeamId]:100};l(n);let u=null;t("postResult",(function(e){u=e})),await onexecute(a,s,{},n),e.deepEqual(u,{[ChannelIsSuccessful]:!0}),e.pass()}),s.default.serial("onexecuteSendMessage (of a Channel) succeeds",async e=>{let a=Channel,s=ChannelSendMessage,n={[ChannelId]:345,[ChannelTeamId]:100,[ChannelMessageSubject]:"subject",[ChannelMessageBody]:"body",[ChannelMessageIsImportant]:!0};l(n);let u=null;t("postResult",(function(e){u=e})),await onexecute(a,s,{},n),e.deepEqual(u,{[ChannelIsSuccessful]:!0}),e.pass()});
//# sourceMappingURL=test.js.map
